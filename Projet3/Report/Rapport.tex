\documentclass[a4paper ,12pt,french]{article}
% Packages usuels
%\usepackage{etex} % pour circuitikz
%\usepackage{tikz}
%\usepackage{circuitikz} % pour les circuits électriques

\usepackage[utf8]{inputenc}
%\usepackage[margin=1.55cm]{geometry}
\usepackage[bottom=2cm , left=2.5cm ,right=2.5cm, top=2cm]{geometry}
\usepackage[T1]{fontenc}
\usepackage{url}
%\usepackage{color}
\usepackage{lmodern}
\usepackage[french]{babel}
\usepackage[indentfirst]{titlesec}
\usepackage[dvips]{graphicx}
\usepackage{eurosym}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{makeidx}
\usepackage{array}
\usepackage{colortbl}
\usepackage[table,dvipsnames,svgnames]{xcolor}
\usepackage{xspace}
\usepackage{fancybox}
\usepackage{textcomp}
\usepackage{listings}


\usepackage{hyperref}
\usepackage{setspace}
\usepackage{fancyhdr}
\usepackage{graphicx}

%\usepackage[margin=0.75in]{geometry}
\usepackage[version=3]{mhchem}
%\usepackage{chemist}
\usepackage{multicol}
\usepackage{float}
\usepackage{wrapfig} %écrire txt et image côte à côte
\usepackage[rightcaption]{sidecap}
\usepackage{amsthm}
\usepackage[squaren, Gray, cdot]{SIunits}
\usepackage[absolute]{textpos}%positionnement de cadres
\usepackage[final]{pdfpages} %traitement des pdf
\usepackage{subfigure}
%\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}%pour traiter le code matlab
%\usepackage{setspace}% pour les interlignes
%\onehalfspacing %interligne 1.5
%\doublespacing %interligne 2
%\renewcommand{\baselinestretch}{1.5}  %interligne défini
%\usepackage{vmargin}% pour les marges
%\setmarginsrb{2.5}{2.5}{2.5}{2.5}{}{}{}{} % marges de 2.5 cm 
%\addto\captionsfrench{\def\tablename{Tableau}} % pour avoir TABLEAU et pas TABLE dans la légende des tableaux..
%\setlength{\parskip}{1cm}   %espacement fixe entre chaque paragraphe
\setlength{\parindent}{1cm}  %modifie la valeur de l'alinéas
%\addtolength{\voffset}{-1.5cm} % (diminue la marge du haut)
\addtolength{\textheight}{-2cm} % (augmente la longueur du texte)
%\addtolength{\hoffset}{-1cm} (diminue la marge de gauche)
%\addtolength{\textwidth}{2cm}  (augmente la largeur du texte)
%\addtocounter{secnumdepth}{1}  si jamais on veut utiliser \subsubsubsecion
\usepackage[hang,center,bf]{caption} %pour les légendes
\setlength{\captionmargin}{30pt}
\usepackage[hang,flushmargin]{footmisc} %à mettre avec ENGLISH dans babel pour avoir les notes de bas de page à gauche et non indentées
\usepackage[nonumberlist,style=altlist,toc]{glossaries} % Pour faire un glossaire
\makeglossaries
%\addto\captionsfrench{\renewcommand*{\glossaryname}{Glossary}}
\usepackage{wasysym}
\usepackage[square, numbers, comma, sort&compress]{natbib} % Use the natbib reference package - read up on this to edit the reference style; if you want text (e.g. Smith et al., 2012) for the in-text references (instead of numbers), remove 'numbers' 
%\hypersetup{urlcolor=blue, colorlinks=true} % Colors hyperlinks in blue - change to black if annoying
\title{Project 2 - Constraint Programming } % Defines the thesis title - don't touch this
%-------------------------------------------------------------------------------------------------------------------------------------------------------------




\begin{document}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{ %
  language=c,                				% the language of the code
  basicstyle=\footnotesize,           	% the size of the fonts that are used for the code
  numbers=left,                   			% where to put the line-numbers
  numberstyle=\tiny\color{gray},  	% the style that is used for the line-numbers
  stepnumber=1,                   			% the step between two line-numbers. If it's 1, each line 
                                  						% will be numbered
  numbersep=5pt,                  			% how far the line-numbers are from the code
  backgroundcolor=\color{white},   % choose the background color. You must add \usepackage{color}
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  frame=single,                   % adds a frame around the code
  rulecolor=\color{black},        % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. commens (green here))
  tabsize=4,                      % sets default tabsize to 2 spaces
  captionpos=b,                   % sets the caption-position to bottom
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  title=\lstname,                   % show the filename of files included with \lstinputlisting;
                                  % also try caption instead of title
  keywordstyle=\color{blue},          % keyword style
  commentstyle=\color{dkgreen},       % comment style
  stringstyle=\color{mauve},         % string literal style
  escapeinside={\%*}{*)},            % if you want to add LaTeX within your code
  morekeywords={*,...}               % if you want to add more keywords to the set
}

\floatstyle{plain}
%\newfloat{graphique}{!hb}{lgr}[chapter]
\floatname{graphique}{Graph}

%\setstretch{1.1} % Line spacing of 1.3

% Define the page headers using the FancyHdr package and set up for one-sided printing
\fancyhead{} % Clears all page headers and footers
\rhead{\thepage} % Sets the right side header to show the page number
\lhead{} % Clears the left side page header

\pagestyle{fancy} % Finally, use the "fancy" page style to implement the FancyHdr headers

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % New command to make the lines in the title page

\begin{titlepage}
\pagestyle{fancy} % Finally, use the "fancy" page style to implement the FancyHdr headers

\begin{tabular}{cc}
\begin{minipage}{0.5\textwidth}
\begin{flushleft}
\includegraphics[scale=0.1]{./logoingisbleu.jpg} % University/department logo - uncomment to place it
\end{flushleft}
\end{minipage}
 & 
 \begin{minipage}{0.43\textwidth}
\begin{flushright}
\includegraphics[scale=0.5]{./epl.jpg} % University/department logo - uncomment to place it
\end{flushright}
\end{minipage}
\end{tabular} 



\begin{center}
\vspace{100 px}
\textsc{\LARGE Catholic University of Louvain}\\[1cm] % University name
\textsc{\Large Project 3 : Search}\\[0.5cm] % Thesis type
 
\HRule \\[0.4cm] % Horizontal line
{\huge \bfseries LINGI2365 - Constraint Programming}\\[0.4cm] % Thesis title
\HRule \\[1.5cm] % Horizontal line
 

\begin{tabular}{cc}
\begin{minipage}{0.5\textwidth}
\begin{flushleft} \large
\emph{Auteurs:}\\
{Vanwelde Romain (3143-10-00)\\
Crochelet Martin (2236-10-00)\\ \ \\
Groupe 7} 
\end{flushleft}
\end{minipage} & \begin{minipage}{0.46\textwidth}
\centering
\begin{flushright} \large
\emph{Superviseurs:} \\
{Pr. Yves Deville\\
François Aubry
}
\end{flushright}
\end{minipage}\\[3cm] \\ 
\end{tabular} 

 
%\large \textit{A thesis submitted in fulfilment of the requirements\\ for the degree of \degreename}\\[0.3cm] % University requirement text
%\textit{in the}\\[0.4cm]
%\groupname\\\deptname\\[2cm] % Research group name and department name

 \begin{center}
{\large \today }\\[4cm] % Date 
 \end{center}


\vfill
\end{center}

\end{titlepage}

\lhead{\emph{Table of Contents}} % Set the left side page header to "Contents"
\tableofcontents % Write out the Table of Contents

\thispagestyle{fancy}

\pagebreak
\setcounter{page}{1}
\pagestyle{fancy} % Finally, use the "fancy" page style to implement the FancyHdr headers

\section{The Brussels airport problem}

\subsection{Explain the given model}
TODO
\subsection{Design 2 different variable and/or value ordering heuristics for this problem.}
TODO
\subsection{Which criteria are meaningful for comparing different search strategies?}
TODO
\subsection{Based on your criteria, compare your heuristics with the labelFF heuristic by testing them on the instance on iCampus.}
TODO
\subsection{Consider the following strategy. \dots Give an example with three planes where this strategy is wrong}
TODO

\section{The Knapsack Problem}

\subsection{A Branch \& Bound approach}

\subsubsection{Model the knapsack problem as Constraint Optimization}
\lstinputlisting[language=C]{knapsack.co}

\subsubsection{Describe your model in the report.}

We use 4 data variables: 
\begin{itemize}
\item \textbf{no}, the number of objects
\item \textbf{weight}, an array with the weight of each object
\item \textbf{usefulness}, an array with the usefulness of each object
\item \textbf{C}, the capacity of the knapsack\\
\end{itemize}

and 2 model variables:
\begin{itemize}
\item \textbf{bin}, with a domain wich is [0,1]. When an object has the value 0, it is not in the knapsack, and when it has value 1, it is in the knapsack.
\item \textbf{load} is the weight of all the objects wich are curently in the knapsack.\\
\end{itemize}

Then we use the structure to solve constraint optimisation problems :
\begin{verbatim}
maximize<cp>
    objective_function
subject to {
    constraints
} using {
    search_heuristic
}
\end{verbatim}

The objective function (that we maximize) is the total of the actual usefulness of the knapsack.\\
The constraints prevent to fill the knapsack with more weight than allowed.\\
Search\_heuristic are discussed in the following section.



\subsubsection{Design 3 different heuristics for variable selection.}
The first heuristic assigns variables which have the smallest weight first. Indeed, we could probably put more object in the knapsack, and fill it better with this strategy.\\
The second heuristic assigns variables which have the biggest utility first. Since the utility of those objects is bigger, they will probably be in the final solution.\\
The third heuristic tries to combine the 2 presented here above. It assigns objects with the higher value for ratio usefulness/weight. Object with higher ratio will also tend to be in the final solution.\\

\subsubsection{Test your heuristics and the labelFF heuristic on the knapsack-A instances.}

\begin{figure}[!h]
\begin{tabular}{|r||r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
time :&H1&H2&H3&H4&H5&H6&H7&H8&H9&H10\\
\hline
\hline
s1&76&37&21&50&73&95&219&318&1098&2189\\
\hline
s2&15&10&9&14&20&27&63&124&213&349\\
\hline
s3&29&21&22&28&34&63&145&166&899&1476\\
\hline
ff&17&15&10&18&26&45&98&113&672&1034\\
\hline
\end{tabular}\\
\caption{Search time depending on instances and heuristics}
\end{figure}


\begin{figure}[!h]
\begin{tabular}{|r||r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
\#choices&H1&H2&H3&H4&H5&H6&H7&H8&H9&H10\\
\hline
\hline
s1&2151&1068&609&1488&2058&2668&6177&10206&36020&73265\\
\hline
s2&489&343&329&569&697&891&2309&3986&8218&12734\\
\hline
s3&1219&678&736&858&1016&2103&4877&5850&29973&49940\\
\hline
s4&538&468&339&617&860&1590&3756&4431&26737&41081\\
\hline

\end{tabular}\\
\caption{Number of choices depending on instances and heuristics}
\end{figure}

\begin{figure}[!h]
\begin{tabular}{|r||r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
\#fail&H1&H2&H3&H4&H5&H6&H7&H8&H9&H10\\
\hline
\hline
s1&4266&2098&1140&2940&3975&5298&12193&20306&71907&146472\\
\hline
s2&796&507&473&790&1186&1451&3792&7176&13027&21112\\
\hline
s3&1731&1120&1045&1454&1852&3667&8608&10247&55578&90988\\
\hline
s4&722&574&437&847&1149&1966&4781&5723&33206&54804\\
\hline
\end{tabular}\\
\caption{Number of failures depending on instances and heuristics}
\end{figure}


\begin{figure}[!h]
\begin{tabular}{|r||r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
\#propag:&H1&H2&H3&H4&H5&H6&H7&H8&H9&H10\\
\hline
\hline
s1&25586&12644&7115&16302&25829&36401&81296&129069&427978&819394\\
\hline
s2&3634&2197&1840&2451&4878&6845&15387&34646&50685&91129\\
\hline
s3&6250&5299&3798&6189&8609&17699&41002&48293&280535&391867\\
\hline
s4&6306&5371&3867&6210&8680&17772&41030&48393&280603&391948\\
\hline
\end{tabular}
\caption{Number of propagation depending on instances and heuristics}
\end{figure}


Results here above only show the results for the 10 first files. The other results are available in the directory ... TODO

\subsubsection{Present and discuss the results in your report}


TODO


The search strategy we will use for the remainder of this assignment is the second one.

\subsection{Optimization over iterations}

\subsubsection{Model the knapsack problem as a Constraint Satisfaction Problem.}

\lstinputlisting[language=C]{knapsackUB.co}

\subsubsection{In order to implement the optimization over iterations \dots}

We added Integer ub which will be the upper bound, and is assigned thanks to the \texttt{getUB} function. We added a decision variable totalUsefulness which will be forced to take the value of the upper bound. Suceed event that will finish the search, and failure events that will reduce the upper bound from 1 and restart the search.

\subsubsection{Which of these points (i., ii., iii.) do you need to execute on which events?}
In case of success, we succeed in finding the best value for the totalUseffulness (since it can't be bigger than the upper bound). So we end the search (iii). Otherwise, in case of failure, we modify ub value (we decrease by 1), and we restart the search (i and ii).
We will continue like that until the upper bound will be the optimal solution, and then will succeed and end the search.


\subsubsection{How do you modify the value of ub to be sure to find the optimal solution?}

Since we only use integer, we can decrease ub by 1 at each failure.

\subsubsection{Can you explain why we initialize ub with an upper bound instead of any other value?}

If ub is not an upper bound, it means that the search could end with an non optimal value.

\subsubsection{Experiment this program on the instances knapsack-A, -B. }



\begin{figure}[!h]
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
File & ub & totalUsefulness & time & \# choices & \# fail & \# propag\\
\hline
\hline
A1 & 21 & 21 & 9 & 25 & 0 & 27\\
\hline
A2& 21& 21& 9&25&    0& 27\\
\hline
A3& 21& 21& 9&25&    0& 27\\
\hline
A4& 21& 21& 9&25&    0& 27\\
\hline
A5& 26& 26& 9&25&    0& 28\\
\hline
A6& 34& 34& 9&25&    0& 27\\
\hline
A7& 43& 43& 10&25&    0& 28\\
\hline
A8& 44& 44& 10&25&    0& 28\\
\hline
A9& 45& 45& 9&25&    0& 28\\
\hline
A10& 47& 47& 8&25&    0& 28\\
\hline
A11& 50& 50& 9&25&    0& 28\\
\hline
A12& 65& 65& 9&25&    0& 29\\
\hline
A13& 69& 69& 9&25&    0& 29\\
\hline
A14& 73& 73& 9&25&    0& 30\\
\hline
A15& 70& 70& 9&25&    0& 29\\
\hline
A16& 78& 78& 9&25&    0& 29\\
\hline
A17& 89& 89& 9&25&    0& 30\\
\hline
A18& 86& 86& 9&25&    0& 30\\
\hline
A19& 106& 106& 9&25&    0& 31\\
\hline
A20& 110& 110& 10&25&    0& 31\\
\hline
A21& 117& 117& 9&25&    0& 32\\
\hline
A22& 104& 104& 8&25&    0& 33\\
\hline
A23& 98& 98& 9&25&    0& 31\\
\hline
A24& 131& 131& 9&25&    0& 33\\
\hline
A25& 103& 103& 9&25&    0& 32\\
\hline
\end{tabular}
\end{figure}


\begin{figure}[!h]
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
File & ub & totalUsefulness & time & \# choices & \# fail & \# propag\\
\hline
\hline
B1&934&934&9&50&0&53
\\ \hline
B2&934&934&10&50&0&52
\\ \hline
B3&947&947&10&50&0&52
\\ \hline
B4&943&943&9&50&0&55
\\ \hline
B5&872&872&10&50&0&53
\\ \hline
B6&835&835&10&50&0&52
\\ \hline
B7&826&826&10&50&0&54
\\ \hline
B8&859&859&10&50&0&53
\\ \hline
B9&836&836&10&50&0&54
\\ \hline
B10&951&951&10&50&0&54
\\ \hline
B11&891&891&9&50&0&54
\\ \hline
B12&817&817&9&50&0&54
\\ \hline
B13&880&880&10&50&0&55
\\ \hline
B14&836&836&10&50&0&54
\\ \hline
B15&826&826&9&50&0&52
\\ \hline
B16&796&796&11&50&0&54
\\ \hline
B17&878&878&10&50&0&54
\\ \hline
B18&858&858&10&50&0&55
\\ \hline
B19&843&843&9&50&0&54
\\ \hline
B20&904&904&9&50&0&53
\\ \hline
B21&836&836&9&50&0&52
\\ \hline
B22&883&883&9&50&0&54
\\ \hline
B23&794&794&9&50&0&53
\\ \hline
B24&802&802&10&50&0&55
\\ \hline
B25&805&805&9&50&0&56
\\ \hline
\end{tabular}
\end{figure}




\subsubsection{Present and discuss the results in your report.}

TODO

\subsection{Optimization via divide and conquer}

\subsubsection{In order to implement the optimization via divide and conquer you will have to \dots}
\lstinputlisting[language=C]{knapsackUB_LB.co}
\subsubsection{Which of these points (i., ii., iii., iv.) do you need to execute on which events?}
Note : Since the search runs on domain $[ceil(\frac{lb + ub}{2}),ub]$, we are sure that if there is a solution , this is not the lb. So, if lb=34 and ub=35, ceil function will makes the search on the domain [35,35] and not [34,35] if we had used the floor function, wich would have made the rest of the program more complicated.\\\\

In case of success, we have to update the lower bound to the lower value of the domain used for the search which is the new lower bound (since there were a solution with this bound) (i). If this new lower bound is equal to the upper bound, we have find the optimal value, and we can end the search (iv), otherwise, we have to continue the search (iii).\\

In case of failure, we have no solutions in the interval $[ceil(\frac{lb + ub}{2}),ub]$, thus we can change the upper bound to $ceil(\frac{lb + ub}{2})-1$ (ii), and restart the search (iii).\\


\subsubsection{Experiment this version on the instances knapsack-A,-B,-C}

\begin{figure}[!h]
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
file&lb&ub&totalUsefulness&\# search&time\\
\hline
\hline
A1&20&21&21&1&10\\ \hline
A2&21&21&21&1&9\\ \hline
A3&21&21&21&1&10\\ \hline
A4&21&21&21&1&10\\ \hline
A5&25&26&26&1&10\\ \hline
A6&33&34&34&1&9\\ \hline
A7&43&43&43&1&10\\ \hline
A8&44&44&44&1&10\\ \hline
A9&45&45&45&1&11\\ \hline
A10&47&47&47&1&9\\ \hline
A11&50&50&50&1&10\\ \hline
A12&65&65&65&1&11\\ \hline
A13&69&69&69&1&11\\ \hline
A14&73&73&73&1&10\\ \hline
A15&69&70&70&1&11\\ \hline
A16&76&78&78&2&10\\ \hline
A17&89&89&89&1&11\\ \hline
A18&86&86&86&1&10\\ \hline
A19&106&106&106&1&10\\ \hline
A20&110&110&110&1&10\\ \hline
A21&117&117&117&1&9\\ \hline
A22&104&104&104&1&10\\ \hline
A23&98&98&98&1&10\\ \hline
A24&130&131&131&1&10\\ \hline
A25&103&103&103&1&10\\ \hline
\end{tabular}
\end{figure}


\begin{figure}[!h]
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
file&lb&ub&totalUsefulness&\# search&time\\
\hline
\hline
B1&622&934&934&9&15\\ \hline
B2&642&934&934&9&15\\ \hline
B3&774&947&947&8&15\\ \hline
B4&696&943&943&8&15\\ \hline
B5&602&872&872&9&15\\ \hline
B6&651&835&835&8&14\\ \hline
B7&589&826&826&8&15\\ \hline
B8&636&859&859&8&15\\ \hline
B9&582&836&836&8&15\\ \hline
B10&811&951&951&8&15\\ \hline
B11&775&891&891&7&14\\ \hline
B12&676&817&817&8&15\\ \hline
B13&671&880&880&8&16\\ \hline
B14&592&836&836&8&15\\ \hline
B15&706&826&826&7&14\\ \hline
B16&738&796&796&6&14\\ \hline
B17&618&878&878&9&15\\ \hline
B18&628&858&858&8&15\\ \hline
B19&642&843&843&8&15\\ \hline
B20&734&904&904&8&14\\ \hline
B21&640&836&836&8&14\\ \hline
B22&741&883&883&8&14\\ \hline
B23&670&794&794&7&15\\ \hline
B24&524&802&802&9&15\\ \hline
B25&665&805&805&8&14\\ \hline
\end{tabular}
\end{figure}


\begin{figure}[!h]
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
file&lb&ub&totalUsefulness&\# search&time\\
\hline
\hline
C1&62&103&103&6&16\\ \hline
C2&72&99&99&5&15\\ \hline
C3&77&94&94&5&15\\ \hline
C4&86&110&110&5&15\\ \hline
C5&87&108&108&5&15\\ \hline
C6&86&97&97&4&14\\ \hline
C7&87&113&113&5&16\\ \hline
C8&87&128&128&6&16\\ \hline
C9&92&116&116&5&15\\ \hline
C10&85&105&105&5&15\\ \hline
C11&93&125&125&6&15\\ \hline
C12&67&115&115&6&16\\ \hline
C13&91&115&115&5&14\\ \hline
C14&76&115&115&6&16\\ \hline
C15&99&120&120&5&15\\ \hline
C16&91&116&116&5&15\\ \hline
C17&67&98&98&5&16\\ \hline
C18&83&111&111&5&15\\ \hline
C19&72&99&99&5&15\\ \hline
C20&75&117&117&6&16\\ \hline
C21&73&110&110&6&15\\ \hline
C22&84&108&108&5&15\\ \hline
C23&73&115&115&6&17\\ \hline
C24&90&109&109&5&15\\ \hline
C25&82&116&116&6&16\\ \hline


\end{tabular}
\end{figure}



\subsubsection{Present and discuss the results in your report.}
TODO
\end{document}